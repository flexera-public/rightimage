<% if @bootstrap -%>
[main]
cachedir=/var/cache/yum
debuglevel=2
logfile=/var/log/yum.log
exclude=*-debuginfo
gpgcheck=0
obsoletes=1
pkgpolicy=newest
distroverpkg=redhat-release
tolerant=1
exactarch=1
reposdir=/dev/null
metadata_expire=1800
plugins=1
<% end -%>

[base]
name = none
baseurl = http://<%= @mirror %>/centos/<%= node[:rightimage][:platform_version].to_i %>/os/<%= node[:rightimage][:arch] %>/archive/<%= @mirror_date %>/
failovermethod=priority
gpgcheck=1
enabled=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7

[centosplus]
name = none
baseurl = http://<%= @mirror %>/centos/<%= node[:rightimage][:platform_version].to_i %>/centosplus/<%= node[:rightimage][:arch] %>/archive/<%= @mirror_date %>/
failovermethod=priority
gpgcheck=1
enabled=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7

[extras]
name = none
baseurl = http://<%= @mirror %>/centos/<%= node[:rightimage][:platform_version].to_i %>/extras/<%= node[:rightimage][:arch] %>/archive/<%= @mirror_date %>/
failovermethod=priority
gpgcheck=1
enabled=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7

[updates]
name = none
baseurl = http://<%= @mirror %>/centos/<%= node[:rightimage][:platform_version].to_i %>/updates/<%= node[:rightimage][:arch] %>/archive/<%= @mirror_date %>/
failovermethod=priority
gpgcheck=1
enabled=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7

[epel]
name = none
baseurl = http://mirrors.kernel.org/fedora-epel/7/x86_64/
failovermethod=priority
gpgcheck=1
enabled=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL<%= epel_key_name %>

[rightscale-epel]
name = none
<% if @use_staging_mirror.to_s == "true" && @bootstrap -%>
baseurl = http://rightscale-software-staging.s3.amazonaws.com/centos/<%= node[:rightimage][:platform_version].to_i %>/<%= node[:rightimage][:arch] %>
<% else -%>
baseurl = http://<%= @mirror %>/rightscale_software/epel/<%= node[:rightimage][:platform_version].to_i %>/<%= node[:rightimage][:arch] %>/archive/<%= @mirror_date %>/
  http://ec2-us-east-mirror.rightscale.com/rightscale_software/epel/<%= node[:rightimage][:platform_version].to_i %>/<%= node[:rightimage][:arch] %>/archive/<%= @mirror_date %>/
  http://ec2-us-west-mirror.rightscale.com/rightscale_software/epel/<%= node[:rightimage][:platform_version].to_i %>/<%= node[:rightimage][:arch] %>/archive/<%= @mirror_date %>/
<% end -%>
failovermethod=priority
gpgcheck=0
enabled=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-RightScale
# set metadata to expire faster then main
metadata_expire=30
